<!doctype html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="style.css" type="text/css" />
</head>
<body>
	
	<a href='javascript:var EventEmitter={subscribers:{},on:function(a,b){var c=a || "default";this.subscribers[c] || (this.subscribers[c]=[]);this.subscribers[c].push(b)},off:function(a,b){this.subscribers[a]?this.subscribers[a]=this.subscribers[a].filter(function(a){return b!==a}):console.error(a+" not found!")},trigger:function(a,b){b=void 0===b?null:b;var c=this.subscribers[a];if(c)for(var d=0,e=c.length;d<e;d++)c[d](b);else console.log("EE.trigger: not found subscribers for "+a+" event")}},SPACE_SHIP_START_BODY=[2,3,4,
10],MAX_SHIP_CENTER_POSITION=6,MIN_SHIP_CENTER_POSITION=0,SPACE_SHIP_START_POSITION=3,SPACE_SHIP_GUN=SPACE_SHIP_START_POSITION+7,STAR_MATRIX=[6,7,8,12,13,14,15,16,19,20,21,22,23,27,28,29,35],STAR_MATRIX_CLOSE=[26,30,34,36,42],AIM_POSITIONS=[6,8,12,16],START_STAR_POSITION=353,PATH_FOR_STATIC="http://forjob.esy.es/",EVIL_TOP_START_POINT=364,EVIL_BOTTOM_START_POINT=370,FIRE=119,UP=97,DOWN=100,GAME_OVER_TEXT=[7,14,21,63,98,126,140,147,154,189,196,203,224,252,266,273,280,294,301,308,8,57,71,99,106,120,
127,141,183,211,225,253,267,295,316,9,58,72,100,114,128,142,184,212,226,254,268,296,317,10,24,31,52,80,101,129,143,150,157,185,213,227,255,269,276,283,297,304,311,11,32,53,60,67,74,81,102,130,144,186,214,228,256,270,298,305,12,33,47,89,103,131,145,187,215,236,250,271,299,313,13,20,27,34,48,90,104,132,146,153,160,195,202,209,244,272,279,286,300,321,335,349,363],WIN_TEXT=[14,42,63,70,77,98,126,161,182,203,217,224,231,238,245,259,301,322,336,350,15,43,57,85,99,127,162,183,204,232,260,267,302,323,337,
351,23,37,58,86,100,128,163,184,205,233,261,275,303,324,338,352,31,59,87,101,129,164,185,206,234,262,283,304,325,339,353,32,60,88,102,130,165,186,207,235,263,291,305,326,340,354,33,61,89,110,124,131,173,187,201,236,264,299,306,34,69,76,83,118,132,139,181,195,223,230,237,244,251,265,307,328,342,356],Spaceship=function(a){var b=this;this.dataField=a.dataField;this._centerShip=SPACE_SHIP_START_POSITION;this._gun=SPACE_SHIP_GUN;this._died=!1;this.currentPositionShip=[];this.nextPositionShip=[];this.timeDelay=
this._throttle(this._shot.bind(this),400);EventEmitter.on("start game",function(){return b.initShip()});EventEmitter.on("stop game",function(){return b._died=!0});document.addEventListener("keypress",this.checkMove.bind(this))};Spaceship.prototype.initShip=function(){this._centerShip=SPACE_SHIP_START_POSITION;this._gun=SPACE_SHIP_GUN;this._died=!1;this.currentPositionShip=[];this.nextPositionShip=[];this._initBody()};
Spaceship.prototype._initBody=function(){var a=this;SPACE_SHIP_START_BODY.forEach(function(b){b=a.dataField[b];b.el.style.fill="#00f";b.isShip=!0;a.currentPositionShip.push(b)})};Spaceship.prototype._throttle=function(a,b){var c=!1,d=null,e=null;return function f(){this._died || (c?(d=arguments,e=this):(c=!0,a.call(this),setTimeout(function(){c=!1;d && (f.call(e),d=e=null)},b)))}};
Spaceship.prototype.checkMove=function(a){this._died || (a.preventDefault(),a=a.keyCode,a!==FIRE && a!==UP && a!==DOWN) || (a===FIRE?this.timeDelay():this._centerShip===MAX_SHIP_CENTER_POSITION && a===DOWN || this._centerShip===MIN_SHIP_CENTER_POSITION && a===UP || (a===DOWN?++this._centerShip:--this._centerShip,this._prepareMove(),this._move()))};
Spaceship.prototype._prepareMove=function(){this._gun=this._centerShip+7;this.nextPositionShip.push(this.dataField[this._gun]);this.nextPositionShip.push(this.dataField[this._centerShip]);this._centerShip!==MIN_SHIP_CENTER_POSITION && this.nextPositionShip.push(this.dataField[this._centerShip-1]);this._centerShip!==MAX_SHIP_CENTER_POSITION && this.nextPositionShip.push(this.dataField[this._centerShip+1])};
Spaceship.prototype._move=function(){this.currentPositionShip.forEach(function(a){a.el.style.fill="#eee";a.isShip=!1});this.nextPositionShip.forEach(function(a){a.el.style.fill="#00f";a.isShip=!0});this.currentPositionShip=this.nextPositionShip;this.nextPositionShip=[]};Spaceship.prototype._shot=function(){var a=this.dataField[this._gun+7];a.el.style.fill="#f00";a.isBullet=!0;a.time=performance.now();EventEmitter.trigger("play sound",{type:"blaster"})};
Spaceship.prototype.moveBullet=function(a){a.el.style.fill="#eee";a.isBullet=!1;if(a=this.dataField[a.index+7])a.isBullet=!0,a.el.style.fill="#f00",a.time=performance.now()};var StarOfDeath=function(a){this.data=a.data;this.gun=START_STAR_POSITION;this.currentIndex=0;this.timerFire=null};
StarOfDeath.prototype.initStarOfDeath=function(){var a=this;this.data[START_STAR_POSITION].isStar=!0;this.data[START_STAR_POSITION].el.style.fill="#000";this.data[START_STAR_POSITION+6].isAim=!0;this.data[START_STAR_POSITION+6].el.style.fill="#f00";this.gun=START_STAR_POSITION;this.timerFire=setInterval(function(){a._fire()},2E3)};
StarOfDeath.prototype.moveStar=function(a){var b=this,c=a.index-7;a.isStar=!1;a.isStarBody=!1;(a=this.data[c])?(this.gun=c,a.isStar=!0,a.el.style.fill="#000",a.isStarBody=!0,a.time=performance.now(),STAR_MATRIX.forEach(function(a){if(a=b.data[c+a])a.el.style.fill="#000",a.isStarBody=!0}),STAR_MATRIX_CLOSE.forEach(function(a){if(a=b.data[c+a])a.el.style.fill="#eee",a.isStarBody=!1})):EventEmitter.trigger("stop game",{type:"lose"})};
StarOfDeath.prototype._fire=function(){var a=this.data[this.gun-7];a && (a.isBulletStar=!0,a.el.style.fill="#eecb0f")};StarOfDeath.prototype.moveBulletStart=function(a){a.el.style.fill="#eee";a.isBulletStar=!1;if(a=this.data[a.index-7])a.isBulletStar=!0,a.el.style.fill="#eecb0f",a.time=performance.now()};
StarOfDeath.prototype.moveAim=function(a){a.isAim=!1;a.isStarBody && (a.el.style.fill="#000");this.currentIndex+=1;this.currentIndex===AIM_POSITIONS.length && (this.currentIndex=0);a=this.data[this.gun+AIM_POSITIONS[this.currentIndex]];a.isAim=!0;a.time=performance.now();a.el.style.fill="#f00"};
var Evil=function(a){var b=this;this.dataField=a.dataField;this.starOfDie=this.timerIdGeneratorEvilShip=null;this.evilTopStartPoint=EVIL_TOP_START_POINT;this.evilBottomStartPoint=EVIL_BOTTOM_START_POINT;this.starOfDie=new StarOfDeath({data:this.dataField});EventEmitter.on("start game",function(){return b.initEvil()});EventEmitter.on("last fight",function(){return b.starOfDie.initStarOfDeath()});EventEmitter.on("stop game",function(){return clearInterval(b.starOfDie.timerFire)})};
Evil.prototype.initEvil=function(){clearInterval(this.timerIdGeneratorEvilShip);this.evilTopStartPoint=EVIL_TOP_START_POINT;this.evilBottomStartPoint=EVIL_BOTTOM_START_POINT;this._generateEvilShip()};Evil.prototype._generateEvilShip=function(){var a=this;this.timerIdGeneratorEvilShip=setInterval(function(){var b=a.generateStartPosition();a.dataField[b].el.style.fill="#0f0";a.dataField[b].isEnemy=!0;a.dataField[b].time=performance.now()},1E3)};
Evil.prototype.moveShipEvil=function(a,b){var c=this.dataField[a.index-7],d=this.dataField[a.index+7];d && (d.isEnemy=!1,d.el.style.fill="#eee");c?(c.isEnemy=!0,c.el.style.fill="#0f0",c.time=performance.now()):setTimeout(function(){return a.el.style.fill="#eee"},b);a.isEnemy=!1};Evil.prototype.destroy=function(a){EventEmitter.trigger("play sound",{type:"bomb"});a.isEnemy=!1;a.isBullet=!1;a.el.style.fill="#eee";this.dataField[a.index+7] && (this.dataField[a.index+7].el.style.fill="#eee")};
Evil.prototype.destroyAllEnemyShip=function(){var a=this;this.dataField.forEach(function(b){b.isEnemy && (b.isEnemy=!1,b.el.style.fill="#eee",b=a.dataField[b.index+7]) && (b.el.style.fill="#eee")})};Evil.prototype.generateStartPosition=function(){var a=Math.round(Math.random()*(this.evilBottomStartPoint-this.evilTopStartPoint)+this.evilTopStartPoint);return a>=this.dataField.length?a-7:a};
var Processor=function(a){var b=this;this.dataField=a.data;this.score=0;this.isStop=!1;this.enemySpeed=300;this.ship=new Spaceship({dataField:this.dataField});this.evil=new Evil({dataField:this.dataField});EventEmitter.on("start game",function(){return b._startProcessor({data:b.dataField,context:b})});EventEmitter.on("stop game",function(){return b.isStop=!0})};
Processor.prototype._startProcessor=function(a){var b=a.data,c=a.context;this.score=0;this.isStop=!1;this.enemySpeed=300;requestAnimationFrame(function e(){b.forEach(c.checkState.bind(c));c.isStop || requestAnimationFrame(e)})};Processor.prototype.checkState=function(a){switch(!0){case a.isEnemy:this._isEnemyShip(a);break;case a.isBullet:this._isBullet(a);break;case a.isShip:this._isShip(a);break;case a.isBulletStar:this._isBulletStar(a);break;case a.isStar:this._isStar(a);break;case a.isAim:this._isAim(a)}};
Processor.prototype._isEnemyShip=function(a){a.isShip?(clearInterval(this.evil.timerIdGeneratorEvilShip),EventEmitter.trigger("stop game",{type:"lose"})):a.isBullet?(this.evil.destroy(a),this.score+=10,EventEmitter.trigger("update score",{data:this.score}),0 === this.score % 100  &&  (this.enemySpeed*=Game.changeDifficulty(this.score),this._checkScore(this.score))):Processor.animate({duration:this.enemySpeed,draw:this.evil.moveShipEvil.bind(this.evil),rect:a})};
Processor.prototype._isBullet=function(a){a.isBulletStar?(a.el.style.fill="#eee",a.isBulletStar=!1,a.isBullet=!1):a.isAim?EventEmitter.trigger("stop game",{type:"_win"}):a.isStarBody?(a.el.style.fill="#000",a.isBullet=!1):Processor.animate({duration:60,draw:this.ship.moveBullet.bind(this.ship),rect:a})};Processor.prototype._isShip=function(a){(a.isStarBody || a.isBulletStar) && EventEmitter.trigger("stop game",{type:"lose"})};
Processor.prototype._isBulletStar=function(a){Processor.animate({duration:70,draw:this.evil.starOfDie.moveBulletStart.bind(this.evil.starOfDie),rect:a})};Processor.prototype._isStar=function(a){Processor.animate({duration:500,draw:this.evil.starOfDie.moveStar.bind(this.evil.starOfDie),rect:a})};Processor.prototype._isAim=function(a){Processor.animate({duration:800,draw:this.evil.starOfDie.moveAim.bind(this.evil.starOfDie),rect:a})};
Processor.prototype._checkScore=function(a){switch(a){case 200:EventEmitter.trigger("change level",{data:1});break;case 400:EventEmitter.trigger("change level",{data:2});break;case 600:EventEmitter.trigger("change level",{data:3}),clearInterval(this.evil.timerIdGeneratorEvilShip),this.evil.destroyAllEnemyShip(),EventEmitter.trigger("last fight")}};Processor.animate=function(a){var b=a.rect.time;1<=(performance.now()-b)/a.duration && a.draw(a.rect,a.duration)};
var EndGame=function(a){var b=this;this.dataField=a.data;EventEmitter.on("stop game",function(a){"lose"===a.type?setTimeout(function(){b._gameOver()},1E3):b._win()})};EndGame.prototype._gameOver=function(){for(var a=this,b=0;b<this.dataField.length;b++)this.dataField[b].el.style.fill="#eee";var c=0,d=GAME_OVER_TEXT.sort(function(){return Math.random()-.5}),e=setInterval(function(){a.dataField[d[c]].el.style.fill="green";c++;c>=d.length && clearInterval(e)},10)};
EndGame.prototype._win=function(){for(var a=this,b=0;b<this.dataField.length;b++)this.dataField[b].el.style.fill="#eee";var c=0,d=WIN_TEXT.sort(function(){return Math.random()-.5}),e=setInterval(function(){a.dataField[d[c]].el.style.fill="green";c++;c>=d.length && clearInterval(e)},10)};
var Music=function(a){var b=this;this.arrayOfSounds=a;this._init();EventEmitter.on("play sound",function(a){return b.play(a)});EventEmitter.on("stop game",function(a){b.stop({type:"main"});"lose"===a.type?b.play({type:"gameover"}):b.play({type:"win"})})};Music.prototype._init=function(){var a=this;this.arrayOfSounds.forEach(function(b){a[b.name]=new Audio(PATH_FOR_STATIC+b.url);a[b.name].loop=b.loop;a[b.name].volume=b.volume})};
Music.prototype.play=function(a){this[a.type].pause();this[a.type].currentTime=0;this[a.type].paused && this[a.type].play()};Music.prototype.stop=function(a){this[a.type].pause();this[a.type].currentTime=0};
var Game=function(a){var b=this;this._$el=a.el;this._$rectList=this._$el.querySelectorAll("rect");this.dataField=Game.initData(this._$rectList);this.image=document.querySelector(".avatar.width-full.rounded-2");EventEmitter.on("start game",function(){return b.startGame()});EventEmitter.on("change level",function(a){return b.setImageOnPageLevel(a)});EventEmitter.on("update score",Game.updateScoreOnPage);new Processor({data:this.dataField});new EndGame({data:this.dataField});new Music([{name:"main",
url:"main.mp3",loop:!0,volume:.5},{name:"blaster",url:"laser.mp3",loop:!1,volume:1},{name:"bomb",url:"bomb.mp3",loop:!1,volume:1},{name:"gameover",url:"gameover.mp3",loop:!1,volume:1},{name:"win",url:"win.mp3",loop:!1,volume:1}])};Game.prototype.startGame=function(){this._clearData();this.setImageOnPageLevel({data:1});Game.updateScoreOnPage({data:0});EventEmitter.trigger("play sound",{type:"main"})};
Game.prototype._clearData=function(){this.dataField.forEach(function(a){a.isShip=!1;a.isBullet=!1;a.isEnemy=!1;a.isStar=!1;a.isStarBody=!1;a.isBulletStar=!1;a.isAim=!1;a.el.style.fill="#eee"})};Game.initData=function(a){for(var b=[],c=0;c<a.length;c++)b.push({el:a[c],index:c,time:0});return b};Game.prototype.setImageOnPageLevel=function(a){a=a.data;this.image.src=1===a?PATH_FOR_STATIC+"level1.jpg":2===a?PATH_FOR_STATIC+"level2.jpg":PATH_FOR_STATIC+"level3.jpg"};
Game.changeDifficulty=function(a){return 1-Math.floor(a/100)/10};Game.updateScoreOnPage=function(a){a=a.data;document.querySelector(".score-game").innerHTML="Score: "+a};var App=function(a){var b=this;a=a.svg;App.initToolbar(a);new Game({el:a});this.$startBtn=document.getElementById("btn_game_start");this.$startBtnAgain=document.getElementById("btn_game_start_again");this.$startBtn.addEventListener("click",function(){return b.startGame()});this.$startBtnAgain.addEventListener("click",function(){return b.startGame()})};
App.initToolbar=function(a){var b=document.createElement("div");b.innerHTML="<button style=\"display: block; background: #4078c0; border-radius: 2px; padding: 5px 20px; color: #fff; border: 0;\" id=\"btn_game_start\">Start</button>\n\t\t\t<div style=\"position: relative; height: 40px; display: none; background: #fff;\">\n\t\t\t<button style=\"float: left; background: #4078c0; border-radius: 2px; margin-left: 10px; padding: 5px 20px; color: #fff; border: 0;\" id=\"btn_game_start_again\">Try again</button>\n\t\t\t<h2 style=\"text-align: left; margin-left: 100px; float: left\" class=\"score-game\">Score: 0</h2>\n\t\t\t\t<div  style=\"float: left; background: #eee; line-height: 40px; margin-left: 150px; padding: 0 20px;\">\n\t\t\t\t\t<strong style=\"color: #ff7978\">W-</strong>Fire\n\t\t\t\t\t<strong style=\"color: #ff7978\">A-</strong>Up\n\t\t\t\t\t<strong style=\"color: #ff7978\">D-</strong>Down\n\t\t\t\t</div>\n\t\t\t</div>";
b.style.cssText="\n\t\t    position: absolute;\n\t\t    top: -50px;\n\t\t    width: 100 % ;\n\t\t    background: #fff;\n        ";a.parentNode.style.position="relative";a.parentNode.appendChild(b)};App.prototype.startGame=function(){this.$startBtn.style.display="none";this.$startBtn.nextElementSibling.style.display="block";EventEmitter.trigger("start game")};var app=new App({svg:document.querySelector(".js-calendar-graph-svg")});'>An!!!!</a>
	
	
	
	<div id="container">
		<div id="start-container">
			<div class="title">Для сортировки введите числа разделяя их запятой.</div>
			<form class="form">
			<input type="text" name="form" id="sort" class="input" placeholder="например: 1,3,10,884,3,4"/>
			<button type="button" class="btn btn-sort" onclick ="getArr()">Сортировать</button>
			</form>
			<div class="text">
				Работа пузырьковой сортировки реализуется с помощью двух циклов. Первый цикл отвечает за количество проходов по массиву, исходя из количества элементов массива. Второй цикл отвечает, собственно за саму сортировку. Проходя по массиву и выталкивая самое большое число в конец массива. При каждом следующей итерации первого цикла. Количество итераций второго сокращается на количество уже отсортированных чисел(тех что уже протолкнуты в конец массива).
			</div>
		</div>
		<div class="hide" id="end-container">
			<div id = "res"></div>
			<div class="btn-group">
				<button class="btn" onclick="reset()">Сброс</button>
				<button class="btn" id="btn">Вперед</button>
			</div>
		</div>
	</div>
<script type="text/javascript" src="main.js"></script>
		
</body>
</html>
